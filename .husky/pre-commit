#!/usr/bin/env bash
set -euo pipefail

REPO_ROOT="$(git rev-parse --show-toplevel)"
cd "$REPO_ROOT"

changed_files=$(git diff --cached --name-only --diff-filter=ACM || true)

if [ -z "$changed_files" ] || ! printf '%s\n' "$changed_files" | grep -E '^(js/|css/)' >/dev/null; then
  exit 0
fi

scripts/sync-bundles.sh

git add bundle.js bundle.js.map styles.css styles.css.map
